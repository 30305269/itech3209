{% extends "base_generic.html" %}

{% block content %}
	{% load static %}
	{% load templatetags %}
	<script src="{% static 'scripts/view.js'%}"></script>
	<!-- Bootstrap Container -->
	<div class="container">
		
		
		
		
		<li class="list-group-item active">Cards</li>
			<ul id="sortable" class="list-group connection">
			{% for sortedList in sortedList %}
				<ul class="list-group connection cardGroups" value="{{sortedList.card_group.pk}}">
					{% for sortedCards in sortedList.cards.all %}
						{% for sortCards in sortCards %}
							{% if sortedCards.id != sortCards.pk   %}
							<li class="list-group-item" value="{{sortCards.pk}}">{{sortCards }}</li>
							<input type="hidden" name="cardListID" value="{{sortCards.pk}}">	
							{% endif %}
						{% endfor %}
					
				
					{% endfor %}
			{% endfor %}
			</ul>	</ul>			
		
		
		
		{% for sortedList in sortedList %}
			{% if sortedList.user == user %}	
				{% if sortedList.card_package.id == package.pk %}
				
					<div class="cards" value="{{sortedList.card_group.pk}}">
					<li class="list-group-item active" value="{{ sortedList.card_group.title}}">{{ sortedList.card_group}}</li>
					<input id ="sortedCardGroupID" type="hidden" name="sortedCardGroupID" value="{{sortedList.card_group.pk}}">	
					<ul class="list-group connection cardGroups" value="{{sortedList.card_group.pk}}">
					{% for sortedCards in sortedList.cards.all %}
						<li class="list-group-item" value="{{sortedCards.pk}}">{{sortedCards }}</li>
						<input type="hidden" name="sortedCardsID" value="{{sortedCards.pk}}">	
					{% endfor %}
					{% for cardGroups in cardGroups %}		
						{% if cardGroups.card_package.id == package.pk %}
							
							
								
						{% endif %}
					{% endfor %}
					</ul>
					</div>
				{% endif %}	
					</div>
			{% endif %}	
		{% endfor %}	
			
			</br></br></br></br></br></br>
			<form  id="submitForm" class="form-signin" method="post" action="{% url 'comments' package.pk %}" >
			{% csrf_token %}
			<div class="row align-items-start">
			<div class="col">
			<h2>Card Package: {{ package.name}} {% if request.user|has_group:"Staff" %}

			{% endif %}</h2>
			</div>
			</div>
			
			<div class="cards row align-items-center">
			<li class="list-group-item active">Cards</li>
			<ul id="sortable" class="list-group connection">
			{% for cardList in cardList %}
					{% if cardList.card_package.id == package.pk  %}
					<li class="list-group-item" value="{{cardList.pk}}">{{cardList.text }}</li>
					<input type="hidden" name="cardListID" value="{{cardList.pk}}">	
					{% endif %}
			{% endfor %}
			</ul>			
			</div>	
			{% for cardGroups in cardGroups %}		
					{% if cardGroups.card_package.id == package.pk %}
					<div class="cards" value="{{cardGroups.pk}}">
					<li class="list-group-item active" value="{{cardGroups.title}}">{{cardGroups }}</li>
					<input id ="cardGroupID" type="hidden" name="cardGroupID" value="{{cardGroups.pk}}">	
					<ul class="list-group connection cardGroups" value="{{cardGroups.pk}}">
					</ul>
					</div>
					{% endif %}
			{% endfor %}
			
			{% if user.is_authenticated %}
			<div class="row form-group">

				<input id ="cardPackageName" type="hidden" name="name" value="{{package.name}}">			
					{% for comments in comments %}
						<textarea class="form-control" id="commentText" name="comment">{{comments.comment}}</textarea>
						<input id ="commentID" type="hidden" name="commentID" value="{{comments.pk}}">	
						{% empty %}
						<textarea class="form-control" id="commentText" name="comment" placeholder="Feel free to add any comments"></textarea>
					{% endfor %}
				<input id ="cardsList" type="hidden" name="cardsList" >		
				<input id ="cardsGroups" type="hidden" name="cardsGroups" >		
				<input type="submit" value="Save" />	
				
			</div>
			{% endif %}
			<form>
	</div>	
{% endblock %}
